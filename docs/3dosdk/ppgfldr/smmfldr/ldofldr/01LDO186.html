<Title>TimerMsgHeartbeatVBL</Title>
<A NAME="XREF29040"><H1>TimerMsgHeartbeatVBL </A></H1>
 Sends a message periodically based on VBLs.<P>
<H3>Synopsis</H3>
<CODE>TimerHandle TimerMsgHeartbeatVBL (Item msgport, uint32 fields, uint32 userdata1, uint32 userdata2)</CODE><P>
<H3>Description</H3>
Creates a timer that repeatedly notifies you by message after the specified number of VBLs have occurred. The timer continues sending notifications on a regular interval until you use <CODE>TimerSuspend()</CODE> to temporarily halt it or <CODE>TimerCancel()</CODE> to delete it. <P>
The Heartbeat support in the TimerServices thread contains logic to prevent drift in the frequency of timer events. Signals are delivered at the specified frequency even if it takes you significant time to respond to each signal event. <P>
The TimerServices thread must be active before calling this function. <P>
<H3>Arguments</H3>
<DL>
<DT>msgport
<DD>Port to which the notification message is sent. 
</DL>
<DL>
<DT>fields
<DD>Number of VBLs to occur between each event. 
</DL>
<DL>
<DT>userdata1
<DD>Value passed back to you in the msg_DataPtr field of the notification message. 
</DL>
<DL>
<DT>userdata2
<DD>Value passed back to you in the msg_DataSize field of the notification message. 
</DL>
<H3>Return Value</H3>
A TimerHandle (a positive value) on success or a negative error code. <P>
<H3>Implementation</H3>
Library call implemented in lib3do.lib. <P>
<H3>Associated Files</H3>
lib3do.lib, timerutils.h<P>
<H3>See Also</H3>
<CODE><A HREF="./01LDO182.html#XREF20645"><CODE>TimerMsgAfterDelayVBL</A>, <A HREF="./01LDO184.html#XREF29713">TimerMsgAtTimeVBL</A> </CODE><P>
</CODE>