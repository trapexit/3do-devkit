<Title>ExecuteAsSubroutine</Title>
<A NAME="XREF38016"><H1>ExecuteAsSubroutine </A></H1>
<A NAME="XREF16025"> Executes previously loaded code as a subroutine.</A><P>
<H3>Synopsis</H3>
<CODE>int32 ExecuteAsSubroutine(CodeHandle code,int32 argc, char **argv);</CODE><P>
<H3>Description</H3>
This function lets you execute a chunk of code that was previously loaded from disk using <CODE>LoadCode()</CODE>. The code will run as a subroutine of the current task or thread. <P>
In order to function correctly, code being run as a subroutine should be linked with subroutinestartup.o instead of the usual cstartup.o. <P>
The argc and argv parameters are passed directly to the <CODE>main()</CODE> entry point of the loaded code. The return value of this function is the value returned by <CODE>main()</CODE> of the code being run. <P>
The values you supply for argc and argv are irrelevant to this function. They are simply passed through to the loaded code. Therefore, their meaning must be agreed upon by the caller of this function, and by the loaded code. <P>
<H3>Arguments</H3>
<DL>
<DT>code
<DD>A code handle filled in by a previous call to LoadCode(). 
</DL>
<DL>
<DT>argc
<DD> A value that is passed directly as the argc parameter to the loaded code's main() entry point. This function doesn't use the value of this argument, it is simply passed through to the loaded code. 
</DL>
<DL>
<DT>argv
<DD>A value that is passed directly as the argv parameter to the loaded code's main() entry point. This function doesn't use the value of this argument, it is simply passed through to the loaded code. 
</DL>
<H3>Return Value</H3>
Returns the value that the loaded code's <CODE>main()</CODE> function returns. <P>
<H3>Implementation</H3>
Folio call implemented in file folio V21. <P>
<H3>Caveats</H3>
If code being executed as a subroutine calls <CODE>exit()</CODE>, the parent thread or task will exit, not just the subroutine code. <P>
<H3>Associated Files</H3>
filefunctions.h<P>
<H3>See Also</H3>
<CODE><A HREF="./02spr011.html#XREF35386"><CODE>LoadCode</A>(), <A HREF="./02spr022.html#XREF19343">UnloadCode</A>(), <A HREF="./02spr009.html#XREF27642">ExecuteAsThread</A>() </CODE><P>
</CODE>